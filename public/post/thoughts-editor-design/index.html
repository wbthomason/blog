<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
	<link href="http://gmpg.org/xfn/11" rel="profile">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">

	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

	<title>
		
		something bloglike &middot; Thoughts on Text Editor Design
		
	</title>

	
  <link rel="stylesheet" href="https://wbthomason.github.io/blog//css/poole.css">
	<link rel="stylesheet" href="https://wbthomason.github.io/blog//css/syntax.css">
	<link rel="stylesheet" href="https://wbthomason.github.io/blog//css/lanyon.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
	<link
												href="https://fonts.googleapis.com/css?family=Raleway|EB+Garamond|Bitter"
						rel="stylesheet" type="text/css">

	
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
	<link rel="shortcut icon" href="https://wbthomason.github.io/blog//assets/favicon.ico">

	
	<link rel="alternate" type="application/rss+xml" title="RSS" href="https://wbthomason.github.io/blog//atom.xml">
	<script
																															src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	<script src="https://wbthomason.github.io/blog//js/scroll.js"></script>
	<script type="text/x-mathjax-config">
MathJax.Hub.Config({
		tex2jax: {
			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
			processEscapes: true
		}
	});
	</script><Paste>
	<script type="text/javascript"
				 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	<link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.3.0/styles/default.min.css">
	<script src="//cdn.jsdelivr.net/highlight.js/9.3.0/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<script type="text/javascript" src="https://wbthomason.github.io/blog//js/footnotes.js"></script>

</head>


  <body class="layout-reverse">

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-top-image sidebar-item">
    <img src="/media/about-photo.jpg" class="sidebar-photo"/>
  </div>
  <h3 class="sidebar-item sidebar-top-name"> Wil Thomason </h3>

  <div class="sidebar-item sidebar-top-desc">
    <p>
      I'm a researcher, coder, and side-project addict. Currently, I'm working
      toward a PhD in CS at Cornell University. I make robots do interesting
      things.
    </p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">home</a>

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <a class="sidebar-nav-item " href="https://wbthomason.github.io/blog/fixed/tags/">tags</a>
    
    
    
    <a class="sidebar-nav-item " href="https://wbthomason.github.io/blog/fixed/archives/">archives</a>
    
    
    
    

    <span class="sidebar-nav-item"> Themed with <a
          href="https://github.com/tummychow/lanyon-hugo">Lanyon for Hugo</a>,
        heavily modified</span>
  </nav>

</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h1 class="masthead-title">
            <a href="https://wbthomason.github.io/blog/" title="Home">something bloglike</a>
            <small></small>
          </h1>
        </div>
          <nav class="masthead-nav" id="nav">
            <a href="https://wbthomason.github.io/blog//">home</a>
            <a href="https://wbthomason.github.io">wbthomason</a>
          </nav>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">Thoughts on Text Editor Design</h1>
  <span class="post-date">10 Jan 2018</span>
  <span class="reading-time">about 7 minutes</span>
  <div class="post-content"><p>This is a messy collection of thoughts about what a proper, modern text editor should be alongside
some thoughts/planning for the implementation of such an editor. I pulled it straight from my
personal notes, so it&rsquo;s not cleaned up and was originally intended for my personal use. I&rsquo;m putting
it here so that I can more easily get some external opinions on it.</p>

<p></p>

<p>Note that by &ldquo;Vim&rdquo; I usually actually mean &ldquo;Neovim&rdquo; or &ldquo;both Vim and Neovim&rdquo;.</p>

<h2 id="features-properties">Features/Properties</h2>

<p>These are the properties I think are important for any modern text editor, listed in no particular order.</p>

<h3 id="must-have">Must-have</h3>

<ul>
<li><strong>Speed</strong>: The best thing about Vim is how light and fast it feels. It should start roughly as fast as
Vim, and editing should feel instant.</li>
<li><strong>Extensibility/Customizability:</strong> Emacs is great because almost every facet of it can be
customized and tweaked. Vim plugins feel like ugly hacks in comparison, and a lot of Vim feels stuck
in stone &mdash; you can&rsquo;t change arbitrary parts. Ideally, the language for customization should be the
same as the language for implementing the editor to allow for this sort of ultimate customizability.</li>
<li><strong>Terminal-first:</strong> Vim has a great terminal UX and many meh GUI UX&rsquo;s<sup class="footnote-ref" id="fnref:mehgui"><a rel="footnote" href="#fn:mehgui">1</a></sup>. Emacs has a meh
terminal UX<sup class="footnote-ref" id="fnref:mehmacs"><a rel="footnote" href="#fn:mehmacs">2</a></sup>
and a great GUI UX. It&rsquo;s nice to have a good GUI, but for my use terminal comes first.</li>
<li><strong>Async-capable:</strong> While it&rsquo;s not a great idea to implement a threading/async scheduling system
<em>inside</em> the editor (as AFAIK all of Vim, Neovim, and Emacs have done), having async computation
is a must. Ideally this should be derived from the language runtime used for extensibility.</li>
<li><strong>Completions/pop-ups:</strong> There needs to be some way to call a function and display the results in
a pop up, such as for autocompletion. There should also be a default (but overridable) autocompleter.</li>
<li><strong>Regex search:</strong> It should be trivial and fast to search through one or more buffers with a
regex, as well as to perform find/replace operations and edits.</li>
<li><strong>Fast syntax highlighting:</strong> &lsquo;Nuff said. Emacs does better than Vim here.</li>
<li><strong>Minimal redraws:</strong> &lsquo;Nuff said. More of a means of achieving speed than anything else.</li>
<li><strong>Good defaults:</strong> Neovim does a decent job of this, but the default settings should be sane and
represent the most common use case.</li>
<li><strong>Multiple buffers/Windows/Layouts:</strong> It should be easy to have split windows, multiple buffers in
a ring, tabs with different layouts, etc.</li>
<li><strong>A left and right gutter, tabline, and status line:</strong> Not all of these have to display at all
times, but they should all be possible to display.</li>
<li><strong>A good default (but overridable) plugin manager:</strong> The user shouldn&rsquo;t have to install anything
in order to download, install, and use plugins/extensions, but they should be able to replace the
plugin manager with their own solution if they choose.</li>
<li><strong>Theming:</strong> It should be possible to theme the various editor components.</li>
<li><strong>Buffer markup:</strong> Things like line numbers, indentation, whitespace, etc. should be able to be
quickly displayed.</li>
<li><strong>Efficient and extensible movement/commands:</strong> Vim does this better than anyone. The editor
commands are a composable language allowing for rapid and repeatable movement and editing.</li>
<li><strong>Symbol support:</strong> The editor should play nice with ligatures and other &ldquo;fancy symbols&rdquo;, a la
Vim&rsquo;s <code>conceal</code> feature.</li>
<li><strong>Formatting support:</strong> Bold, italic, underline, colored versions of these, etc.</li>
<li><strong>Internal command execution:</strong> Like Vim (and Emacs).</li>
<li><strong>Unicode support:</strong> Duh.</li>
<li><strong>Keymapping support:</strong> Any key should be mappable to any function/command in the editor.</li>
<li><strong>Server mode/Remote UI:</strong> Neovim and Emacs are best in class here. Basically, the core editor
should be a server, and multiple clients should be able to connect to it. However, unlike Emacs, the
editor should be able to run multiple servers at once.</li>
<li><strong>Simple configuration language:</strong> Even if plugins can be written in a &ldquo;real&rdquo; programming
language, configuring the editor should be done through a better suited language &mdash; something
like YAML, TOML, or JSON<sup class="footnote-ref" id="fnref:bothlangs"><a rel="footnote" href="#fn:bothlangs">3</a></sup>.</li>
</ul>

<h3 id="niceties">Niceties</h3>

<ul>
<li><strong>LSP integration:</strong> Adoption of an editor is more likely when the ecosystem of plugins and
features is strong. The LSP provides a way to get state-of-the-art completion and other language
features for free with some degree of future-proofing. Having this support baked in makes it faster,
which is good for such a core piece of functionality.</li>
<li><strong>Multi-language extensions:</strong> Not everyone wants to have to learn a new language to customize
their editor, so it is useful to have a mechanism for writing (maybe limited) extensions in
arbitrary languages. A remote API like Neovim&rsquo;s is a good way to do this.</li>
<li><strong>Good handling of large files</strong>: Emacs does better than Vim here. It can load very large files
from disk and edit with no/minimal latency compared to the lag Vim sometimes sees.</li>
<li><strong>A fuzzy-finder/filter:</strong> Helm, FZF, Unite/Denite, etc. are among the most important/popular
class of plugins for their respective editors. The utility of being able to quickly filter down a
list of {files, buffers, settings, commands, whatever arbitrary data, etc.} is not easily
overstated. This should probably be implemented as an extension, but making sure that good support
for such an extension exists is important.</li>
<li><strong>A file browser:</strong> Something a little more than <code>netrw</code> should be included in the editor.</li>
<li><strong>Multiple cursor support:</strong> Like Sublime.</li>
<li><strong>External command execution:</strong> It should be possible to run a command and see its output/write it to the
buffer. Like Vim/presumably also Emacs.</li>
<li><strong>Something like the quickfix list</strong>: To allow for easy grouped interaction with output.</li>
<li><strong>Reconfiguration without the need to reload the editor:</strong> Config files should be able to be read
and applied without a total editor reload.</li>
<li><strong>Delimiter matching:</strong> This is fundamental enough to coding that it should probably be built in.</li>
<li><strong>Hard and soft line wraps:</strong> People like both of these.</li>
<li><strong>Text re-flowing:</strong> Like <code>gq</code> in Vim/presumably an equivalent in Emacs.</li>
</ul>

<h2 id="implementation-planning">Implementation Planning</h2>

<p>All of these notes are useless if they don&rsquo;t help with an actual editor, so I&rsquo;d like to implement my
own<sup class="footnote-ref" id="fnref:funtimes"><a rel="footnote" href="#fn:funtimes">4</a></sup>. This section has some high-level preliminary planning on how to go about doing this.</p>

<h3 id="language">Language</h3>

<p>The language used to implement the editor should be fast, so probably something compiled. However,
to make extensibility easy, it would be ideal if the language also had an embeddable interpreter (to
avoid the necessity of compiling plugins and re-linking), or some other non-remote API mechanism of
evaluating code. Finally, because I&rsquo;m lazy, I want the language to have good TUI/GUI packages
already in its ecosystem.</p>

<p>OCaml seems like a good choice for this. It&rsquo;s highly performant and has an embeddable toplevel
interpreter. Of course, OCaml is known and used by a relatively small population, which may make
native plugin development less likely to take off.</p>

<p><a href="https://github.com/ChrisPenner/rasa">Rasa</a> uses Haskell and is notable for its extreme modularity.
It might be worthwhile to look into this either as an option for extension or just to copy the
method of script extension.</p>

<p>Something really fast like Rust would be good if I can figure out how to allow total
customizability/extensibility.</p>

<p>A Lisp would be cool, but maybe not as fast. In cursory inspection, I also haven&rsquo;t found a dialect
with solid libraries for all the things I want.</p>

<h3 id="data-structure">Data Structure</h3>

<p>Ropes seem to be the best choice overall, though gap buffers are a common choice for simplicity.
Some parts of the Internet like piece tables, but these don&rsquo;t seem to be chosen by most other modern
text editors, and have some shortcomings.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:mehgui">In my opinion, at least. I know some people love GVim/MacVim/etc., but I&rsquo;ve never found them as nice to use as terminal Vim.
 <a class="footnote-return" href="#fnref:mehgui"><sup>[return]</sup></a></li>
<li id="fn:mehmacs">Again, just my opinion, and relative to Vim.
 <a class="footnote-return" href="#fnref:mehmacs"><sup>[return]</sup></a></li>
<li id="fn:bothlangs">I still need to figure out how to ergonomically have two different languages for configuration/customizability like this. Maybe I should look at how Sublime does this?
 <a class="footnote-return" href="#fnref:bothlangs"><sup>[return]</sup></a></li>
<li id="fn:funtimes">This also just seems fun.
 <a class="footnote-return" href="#fnref:funtimes"><sup>[return]</sup></a></li>
</ol>
</div></div>
</div>

</div>
</div>

<label for="sidebar-checkbox" class="sidebar-toggle"></label>
<footer class="footer-nav">
  <ul>
    <li>
      <a href="https://github.com/wbthomason">
        <span class="icon  icon--github">
          <svg viewBox="0 0 16 16">
            <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
          </svg>
        </span>

        <span class="username">wbthomason</span>
      </a>
    </li>
    <li>
      <a href="https://twitter.com/wilthomason">
        <span class="icon  icon--twitter">
          <svg viewBox="0 0 16 16">
            <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
            c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
          </svg>
        </span>

        <span class="username">wilthomason</span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/in/wbthomason">
        <span class="icon">
          <svg viewBox="0 0 512 512">
            <path fill="#828282" d="M186.4 142.4c0 19-15.3 34.5-34.2
            34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9
            186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8
            201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0
            31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3
            0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"/>
          </svg>
        </span>
        <span class="username">wbthomason</span>
      </a>
    </li>
    <li>
      <a href="mailto:wbthomason@%7bmy%20department,%20abbr.%7d.%7bmy%20university%7d.edu">
        <span class="icon">
          <svg viewBox="0 0 512 512">
            <path fill="#828282" d="M101.3 141.6v228.9h0.3 308.4
            0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6
            194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1
            43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4
            64.4-49.3V307.8z"/>
          </svg>
        </span>
        <span class="username">wbthomason@{my department, abbr.}.{my university}.edu</span>
      </a>
    </li>
  </ul>
</footer>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-75724004-1', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>

